(function(){var e=[].slice;test("context property assignment (using @)",function(){var e,n;return n={},e=function(){return this.method=function(){return n},this},eq(n,e.call({}).method())}),test("unassignable values",function(){var e,n,t,r,o,i,u;for(r={},i=["",'""',"0","f()"].concat(CoffeeScript.RESERVED),u=[],n=0,t=i.length;t>n;n++)o=i[n],u.push(eq(r,function(){var n;try{return CoffeeScript.compile(o+" = v")}catch(n){return e=n,r}}()));return u}),test("boolean operators",function(){var e,n,t,r,o,i,u;return u={},e=0,e||(e=u),eq(u,e),n=1,n||(n=u),eq(1,n),t=0,t&&(t=u),eq(0,t),r=1,r&&(r=u),eq(u,r),o=i=!1,o&&(o=i||!0),eq(!1,o)}),test("compound assignment as a sub expression",function(){var e,n,t,r;return r=[1,2,3],e=r[0],n=r[1],t=r[2],eq(6,e+(n+=t)),eq(1,e),eq(5,n),eq(3,t)}),test("compound assignment should be careful about caching variables",function(){var e,n,t,r,o,i,u,c;return r=0,o=[],o[i=++r]||(o[i]=1),eq(1,o[1]),eq(1,r),null==o[u=++r]&&(o[u]=2),eq(2,o[2]),eq(2,r),o[c=r++]&&(o[c]=6),eq(6,o[2]),eq(3,r),e=function(){return++r,e},(n=e()).four||(n.four=4),eq(4,e.four),eq(4,r),null==(t=e()).five&&(t.five=5),eq(5,e.five),eq(5,r)}),test("compound assignment with implicit objects",function(){var e;return e=void 0,null==e&&(e={one:1}),eq(1,e.one),e&&(e={two:2}),eq(void 0,e.one),eq(2,e.two)}),test("compound assignment (math operators)",function(){var e;return e=10,e-=5,eq(5,e),e*=10,eq(50,e),e/=10,eq(5,e),e%=3,eq(2,e)}),test("more compound assignment",function(){var e,n,t,r;return e={},r=void 0,r||(r=e),r||(r=!0),eq(e,r),n={},r&&(r=!0),eq(r,!0),r&&(r=n),eq(n,r),t={},r=null,null==r&&(r=t),null==r&&(r=!0),eq(t,r)}),test("empty destructuring assignment",function(){return void 0}),test("chained destructuring assignments",function(){var e,n,t,r,o,i;return e=(o=[r={}],t=o[0],i=o,n=i[0],i)[0],eq(r,e),eq(r,n),eq(r,t)}),test("variable swapping to verify caching of RHS values when appropriate",function(){var e,n,t,r,o,i,u,c,s;return e=o={},n=i={},t=u={},c=[n,t,e],e=c[0],n=c[1],t=c[2],eq(i,e),eq(u,n),eq(o,t),s=[n,t,e],e=s[0],n=s[1],t=s[2],eq(u,e),eq(o,n),eq(i,t),r=function(){var r;return r=[n,t,e],e=r[0],n=r[1],t=r[2],r},arrayEq([o,i,u],r()),eq(o,e),eq(i,n),eq(u,t)}),test("#713",function(){var e,n,t,r,o,i,u,c;return u=[o={},i={}],eq(u,(t=u[0],r=u[1],c=u,e=c[0],n=c[1],c)),eq(o,e),eq(o,t),eq(i,n),eq(i,r)}),test("destructuring assignment with splats",function(){var n,t,r,o,i,u,c,s,l,a;return n={},t={},r={},o={},i={},c=[n,t,r,o,i],s=c[0],l=3<=c.length?e.call(c,1,u=c.length-1):(u=1,[]),a=c[u++],eq(n,s),arrayEq([t,r,o],l),eq(i,a)}),test("deep destructuring assignment with splats",function(){var n,t,r,o,i,u,c,s,l,a,f,p,h,q,d,m,g,w,b;return n={},t={},r={},o={},i={},u={},c={},s={},l={},p=[n,[t,r,o,i],u,c,s,l],q=p[0],h=p[1],d=h[0],m=3<=h.length?e.call(h,1,a=h.length-1):(a=1,[]),g=h[a++],w=4<=p.length?e.call(p,2,f=p.length-1):(f=2,[]),b=p[f++],eq(n,q),eq(t,d),arrayEq([r,o],m),eq(i,g),arrayEq([u,c,s],w),eq(l,b)}),test("destructuring assignment with objects",function(){var e,n,t,r,o,i,u;return e={},n={},t={},r={a:e,b:n,c:t},o=r.a,i=r.b,u=r.c,eq(e,o),eq(n,i),eq(t,u)}),test("deep destructuring assignment with objects",function(){var e,n,t,r,o,i,u,c,s,l,a,f,p;return e={},n={},t={},r={},o={a:e,b:{c:{d:[n,{e:t,f:r}]}}},l=o.a,i=o.b,u=i.c,c=u.d,a=c[0],s=c[1],p=s.f,f=s.e,eq(e,l),eq(n,a),eq(t,f),eq(r,p)}),test("destructuring assignment with objects and splats",function(){var n,t,r,o,i,u,c,s;return n={},t={},r={},o={},i={a:{b:[n,t,r,o]}},u=i.a.b,c=u[0],s=2<=u.length?e.call(u,1):[],eq(n,c),arrayEq([t,r,o],s)}),test("destructuring assignment against an expression",function(){var e,n,t,r,o;return e={},n={},t=[e,n],r=t[0],o=t[1],eq(e,r),eq(n,o)}),test("bracket insertion when necessary",function(){var e,n;return e=(null!=(n=[0])?n:[1])[0],eq(e,0)}),test("destructuring assignment with context (@) properties",function(){var e,n,t,r,o,i,u,c,s,l;for(e={},n={},t={},r={},o={},s={fn:function(){var i,u;return i=[e,{b:n,c:t},r,o],this.a=i[0],u=i[1],this.b=u.b,this.c=u.c,this.d=i[2],this.e=i[3],i}},l=["a","b","c","d","e"],i=0,c=l.length;c>i;i++)u=l[i],eq(void 0,s[u]);return s.fn(),eq(e,s.a),eq(n,s.b),eq(t,s.c),eq(r,s.d),eq(o,s.e)}),test("#1024",function(){return eq(16,16)}),test("#1005: invalid identifiers allowed on LHS of destructuring assignment",function(){var e,n,t,r,o,i;for(e=["eval","arguments"].concat(CoffeeScript.RESERVED),throws(function(){return CoffeeScript.compile("["+e.join(", ")+"] = x")},null,"all disallowed"),throws(function(){return CoffeeScript.compile("["+e.join("..., ")+"...] = x")},null,"all disallowed as splats"),r=o=null,n=0,t=e.length;t>n;n++)i=e[n],"class"!==i&&(throws(function(){return CoffeeScript.compile(r)},null,r="["+i+"] = x"),throws(function(){return CoffeeScript.compile(o)},null,o="["+i+"...] = x"));return doesNotThrow(function(){var n,t,r;for(r=[],n=0,t=e.length;t>n;n++)i=e[n],CoffeeScript.compile("[a."+i+"] = x"),CoffeeScript.compile("[a."+i+"...] = x"),CoffeeScript.compile("[@"+i+"] = x"),r.push(CoffeeScript.compile("[@"+i+"...] = x"));return r})}),test("#2055: destructuring assignment with `new`",function(){var e;return e=(new Array).length,eq(0,e)}),test("existential assignment",function(){var e,n,t,r;return r={},e=!1,null==e&&(e=r),eq(!1,e),n=void 0,null==n&&(n=r),eq(r,n),t=null,null==t&&(t=r),eq(r,t)}),test("#1627: prohibit conditional assignment of undefined variables",function(){return throws(function(){return CoffeeScript.compile("x ?= 10")},null,"prohibit (x ?= 10)"),throws(function(){return CoffeeScript.compile("x ||= 10")},null,"prohibit (x ||= 10)"),throws(function(){return CoffeeScript.compile("x or= 10")},null,"prohibit (x or= 10)"),throws(function(){return CoffeeScript.compile("do -> x ?= 10")},null,"prohibit (do -> x ?= 10)"),throws(function(){return CoffeeScript.compile("do -> x ||= 10")},null,"prohibit (do -> x ||= 10)"),throws(function(){return CoffeeScript.compile("do -> x or= 10")},null,"prohibit (do -> x or= 10)"),doesNotThrow(function(){return CoffeeScript.compile("x = null; x ?= 10")},"allow (x = null; x ?= 10)"),doesNotThrow(function(){return CoffeeScript.compile("x = null; x ||= 10")},"allow (x = null; x ||= 10)"),doesNotThrow(function(){return CoffeeScript.compile("x = null; x or= 10")},"allow (x = null; x or= 10)"),doesNotThrow(function(){return CoffeeScript.compile("x = null; do -> x ?= 10")},"allow (x = null; do -> x ?= 10)"),doesNotThrow(function(){return CoffeeScript.compile("x = null; do -> x ||= 10")},"allow (x = null; do -> x ||= 10)"),doesNotThrow(function(){return CoffeeScript.compile("x = null; do -> x or= 10")},"allow (x = null; do -> x or= 10)"),throws(function(){return CoffeeScript.compile("-> -> -> x ?= 10")},null,"prohibit (-> -> -> x ?= 10)"),doesNotThrow(function(){return CoffeeScript.compile("x = null; -> -> -> x ?= 10")},"allow (x = null; -> -> -> x ?= 10)")}),test("more existential assignment",function(){return null==global.temp&&(global.temp=0),eq(global.temp,0),global.temp||(global.temp=100),eq(global.temp,100),delete global.temp}),test("#1348, #1216: existential assignment compilation",function(){var e,n,t;return t={},e=t,n=null!=e?e:e=0,eq(t,n),eq(null!=e?e:e=null!=n?n:n=1,t),e?null==e&&(e=2):e=3,eq(e,t)}),test("#1591, #1101: splatted expressions in destructuring assignment must be assignable",function(){var e,n,t,r,o,i,u;for(r={},i=["",'""',"0","f()","(->)"].concat(CoffeeScript.RESERVED),u=[],n=0,t=i.length;t>n;n++)o=i[n],u.push(eq(r,function(){var n;try{return CoffeeScript.compile("["+o+"...] = v")}catch(n){return e=n,r}}()));return u}),test("#1643: splatted accesses in destructuring assignments should not be declared as variables",function(){var e,n,t,r,o,i,u,c,s,l,a,f,p,h,q,d,m;for(p={},n=["o.a",'o["a"]',"(o.a)","(o.a).a","@o.a","C::a","C::","f().a","o?.a","o?.a.b","f?().a"],u=0,s=n.length;s>u;u++)for(e=n[u],h=[1,2,3],i=c=0,l=h.length;l>c;i=++c)o=h[i],t="nonce = {}; nonce2 = {}; nonce3 = {};\n@o = o = new (class C then a:{}); f = -> o\n["+new Array(o).join("x,")+e+"...] = ["+new Array(o).join("0,")+"nonce, nonce2, nonce3]\nunless "+e+"[0] is nonce and "+e+"[1] is nonce2 and "+e+"[2] is nonce3 then throw new Error('[...]')",eq(p,function(){var e;try{return CoffeeScript.run(t,{bare:!0})}catch(e){return r=e,!0}}()?void 0:p);for(m=["[sub, sub2, sub3]","{0: sub, 1: sub2, 2: sub3}"],q=[],f=0,a=m.length;a>f;f++)d=m[f],q.push(function(){var e,n,u,c;for(u=[1,2,3],c=[],i=n=0,e=u.length;e>n;i=++n)o=u[i],t="nonce = {}; nonce2 = {}; nonce3 = {};\n["+new Array(o).join("x,")+d+"...] = ["+new Array(o).join("0,")+"nonce, nonce2, nonce3]\nunless sub is nonce and sub2 is nonce2 and sub3 is nonce3 then throw new Error('[sub...]')",c.push(eq(p,function(){var e;try{return CoffeeScript.run(t,{bare:!0})}catch(e){return r=e,!0}}()?void 0:p));return c}());return q}),test("#1838: Regression with variable assignment",function(){var e;return e="dave",eq(e,"dave")}),test("#2211: splats in destructured parameters",function(){return doesNotThrow(function(){return CoffeeScript.compile("([a...]) ->")}),doesNotThrow(function(){return CoffeeScript.compile("([a...],b) ->")}),doesNotThrow(function(){return CoffeeScript.compile("([a...],[b...]) ->")}),throws(function(){return CoffeeScript.compile("([a...,[a...]]) ->")}),doesNotThrow(function(){return CoffeeScript.compile("([a...,[b...]]) ->")})}),test("#2213: invocations within destructured parameters",function(){return throws(function(){return CoffeeScript.compile("([a()])->")}),throws(function(){return CoffeeScript.compile("([a:b()])->")}),throws(function(){return CoffeeScript.compile("([a:b.c()])->")}),throws(function(){return CoffeeScript.compile("({a()})->")}),throws(function(){return CoffeeScript.compile("({a:b()})->")}),throws(function(){return CoffeeScript.compile("({a:b.c()})->")})})}).call(this);